<div class="container-fluid">
  <div class="container-fluid">
    <div class="card mt-2 mb-3" style="background-color: #fbfbfb; margin-left: 6rem;">
        <div class="card-body">
            <div class="d-flex megabar-header menu">
              <div class="toggle-b-space"></div>
              <div class="menu-middle">
                <H2>{{ modelName }}</H2>
              </div>
              <div class="d-flex justify-content-end">
                <p-calendar
                [(ngModel)]="rangeDates"
                (ngModelChange)="dateFilterChange()"
                selectionMode="range"
                dateFormat="dd/mm"
                [readonlyInput]="true"
                inputId="range"
                placeholder="Filtrer par date/pÃ©riode"
                [showClear]="false"
                (onClearClick)="setCalendar()"
                [showButtonBar]="false"
                [showIcon]="true"
                class="ml-0"
                [style]="{ width: '250px' }"
                [touchUI]="true"
                [showOnFocus]="true"
                [iconDisplay]="'input'"
                (onClickOutside) = "onClickOutside()"
              >
                <ng-template pTemplate="footer">
                  <div style="display: flex; align-items: center">
                    <p-button
                      label="All"
                      styleClass="p-button-text"
                      (click)="allDateFilter()"
                    ></p-button>
                    <p-button
                      label="Aujourd'hui"
                      styleClass="p-button-text"
                      (click)="todayDate()"
                    ></p-button>
                    <p-button
                      label="Hier"
                      styleClass="p-button-text"
                      (click)="yesterdayDate()"
                    ></p-button>
                    <p-button
                      label="Semaine"
                      styleClass="p-button-text"
                      (click)="weekDate()"
                    ></p-button>
                    <p-button
                      label="15 jours"
                      styleClass="p-button-text"
                      (click)="twoWeekDate()"
                    ></p-button>
                    <p-button
                      label="Mois"
                      styleClass="p-button-text"
                      (click)="monthDate()"
                    ></p-button>
                    <p-button styleClass="p-button-text" (click)="previousDate()">
                      <i class="pi pi-arrow-left"></i>
                    </p-button>
                    <p-button styleClass="p-button-text" (click)="nextDate()">
                      <i class="pi pi-arrow-right"></i>
                    </p-button>
                    <p-button
                      label="Clear"
                      styleClass="p-button-text"
                      (click)="clearDate()"
                    ></p-button>
                  </div>
                </ng-template>
              </p-calendar>
              </div>
          </div>
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row">
      <!-- Left Column: Model List -->
      <div class="col-md-3 mb-3" >
        <div class="card shadow-sm rounded" style="background-color: #f8f9fa;">

          <div class="card-body p-3">
            <!-- Filter Input -->
            <div class="flex flex-column gap-2">
              <input
                pInputText
                id="username"
                aria-describedby="username-help"
                [(ngModel)]="filterQuery"
                (input)="filterModels()"
              />
              <small id="username-help">Filter models</small>
            </div>

            <!-- Model List -->
            <div
              class="list-container"
              style="overflow-y: auto; max-height: 65vh"
            >
              <ul class="list-unstyled mb-0">
                <li
                  *ngFor="let model of filteredModels"
                  [class.selected]="model.id === selectedModel.id"
                  class="model-item p-2 mb-2 rounded shadow-sm"
                  style="
                    cursor: pointer;
                    border: 1px solid #ddd;
                    background-color: #ffffff;
                    color: rgb(31, 31, 31);
                  "
                  (click)="selectModel(model)"
                >
                  <div class="d-flex align-items-center">
                    <div class="flex-1">
                      <h6>{{ model.name }}</h6>
                    </div>
                  </div>
                </li>

              </ul>
              <ul *ngIf="filteredModels.length === 0" class="list-unstyled mb-0">
                <li class="model-item p-2 mb-2 rounded shadow-sm">
                  <p class="mt-4" style="text-align: center;font-size: medium">Liste vide</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-9 d-flex flex-column">
        <app-stock-table
          [beginDateString]="beginDateString"
          [endDateString]="endDateString"
          [selectedModel]="selectedModel"
          [datesCount]="datesCount">
        </app-stock-table>
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="card ml-4 mt-2 mb-3 p-3" style="background-color: #fbfbfb">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <H3>Chart</H3>
        </div>
        <div>
          <p-selectButton
            [options]="chartOptions"
            [(ngModel)]="selectedChart"
            (onOptionClick)="chartEnablerChange()"
          ></p-selectButton>
        </div>
        <div>
          <p-inputSwitch
            [(ngModel)]="chartEnabler"
            optionLabel="label"
            optionValue="value"
            (click)="chartEnablerChange()"
          ></p-inputSwitch>
        </div>
      </div>
      <p-card *ngIf="chartEnabler">
        <p-chart
          type="line"
          [data]="basicData"
          [options]="basicOptions"
        ></p-chart>
      </p-card>
    </div>
  </div>
</div>
<p-toast position="bottom-right"></p-toast>
